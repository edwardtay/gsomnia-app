<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>gSomnia â€” Live</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ’¬</text></svg>">
  <link rel="stylesheet" href="/style.css" />
</head>
<body>
  <div class="container">
    <div style="display:flex;align-items:center;gap:10px;margin-bottom:20px;justify-content:space-between;">
      <div style="display:flex;align-items:center;gap:10px;">
        <h1 class="cyberpunk-title">gSomnia</h1>
        <button id="info-btn" class="info-btn" title="About">â„¹ï¸</button>
      </div>
      <button id="ai-btn" class="ai-btn" title="AI Assistant">ğŸ¤– Ask AI</button>
    </div>
    
    <div id="ai-panel" class="ai-panel" style="display:none;">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
        <h3 style="margin:0;color:#a855f7;font-size:16px;">AI Assistant</h3>
        <button id="close-ai" style="background:transparent;border:none;color:#64748b;cursor:pointer;font-size:18px;">âœ•</button>
      </div>
      <div id="ai-chat" style="max-height:200px;overflow-y:auto;margin-bottom:12px;padding:8px;background:rgba(0,0,0,0.2);border-radius:6px;"></div>
      <div style="display:flex;gap:8px;">
        <input id="ai-input" type="text" placeholder="Ask about messages..." style="flex:1;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.1);border-radius:6px;padding:8px;color:#e2e8f0;font-family:Arial,sans-serif;font-size:13px;">
        <button id="ai-send" class="ai-send-btn">Send</button>
      </div>
    </div>
    <div id="info-popup" class="info-popup" style="display:none;">
      <div class="info-popup-content">
        <button id="close-popup" class="close-popup">âœ•</button>
        <h2>gSomnia ğŸ’¬âš¡</h2>
        <p>A real time onchain messaging app built on Somnia's ultra fast blockchain. Every message you send is verified, immutable, and yours forever.</p>
        <p><strong>Why it matters ğŸ§ </strong><br>You own your words. Each message is cryptographically signed and published on chain. No middlemen, no censorship, just pure decentralized communication.</p>
        <p><strong>Try it now ğŸš€</strong><br>Connect your wallet, drop a message, and watch it appear instantly on the Somnia testnet.</p>
        <p style="font-style:italic;color:#a855f7;">The future of chat is on chain...transparent, unstoppable, and truly yours.</p>
      </div>
    </div>
    <div id="status"></div>
    <div id="stream-info" class="info-box">Loading stream infoâ€¦</div>
    
    <div id="toast" class="toast"></div>
    
    <div class="publish-section">
      <div id="pub-status">Not connected</div>
      <div style="display:flex;gap:8px;">
        <button id="connect" class="wallet-btn">Connect Wallet</button>
        <a href="https://cloud.google.com/application/web3/faucet/somnia/shannon" target="_blank" class="faucet-btn">Get Testnet Tokens</a>
      </div>
      <div style="margin-top:12px">
        <textarea id="msg" placeholder="Type a message" rows="3" style="width:100%;" maxlength="280"></textarea>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:6px;margin-bottom:10px;">
          <div style="display:flex;gap:6px;flex-wrap:wrap;">
            <button class="preset-btn" data-msg="gsomnia">gsomnia</button>
            <button class="preset-btn" data-msg="$SOMI to da moon">$SOMI to da moon</button>
            <button class="preset-btn" data-msg="LFG somnia">LFG somnia</button>
          </div>
          <span id="char-count" style="font-size:12px;color:#64748b;">0/280</span>
        </div>
        <button id="send" class="send-btn">Sign & Publish</button>
      </div>
      <div id="result"></div>
    </div>
    
    <div style="display:flex;gap:8px;margin-bottom:12px;align-items:center;">
      <input id="search" type="text" placeholder="Search messages or addresses..." style="flex:1;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.1);border-radius:8px;padding:10px;color:#e2e8f0;font-family:Arial,sans-serif;font-size:14px;">
      <label style="display:flex;align-items:center;gap:6px;font-size:13px;color:#64748b;white-space:nowrap;">
        <input type="checkbox" id="auto-refresh" checked style="cursor:pointer;">
        Auto-refresh
      </label>
    </div>
    <button id="refresh-btn" class="refresh-btn">ğŸ”„ Refresh Messages</button>
    <div id="pagination" style="display:flex;gap:8px;margin-bottom:12px;justify-content:center;"></div>
    <div id="empty-state" style="display:none;text-align:center;padding:40px;color:#64748b;">
      <div style="font-size:48px;margin-bottom:12px;">ğŸ’¬</div>
      <div style="font-size:16px;font-weight:600;margin-bottom:6px;">No messages yet</div>
      <div style="font-size:14px;">Be the first to publish a message!</div>
    </div>
    <ul id="messages"></ul>
    
    <div style="background:#fafafa;border:2px solid #e5e5e5;padding:12px;border-radius:8px;margin-top:24px;text-align:center;">
      <div style="font-size:20px;margin-bottom:6px;">ğŸ†</div>
      <div style="color:#000000;font-weight:700;font-size:15px;margin-bottom:4px;">Every 10th Message Wins an NFT!</div>
      <div style="color:#000000;font-size:13px;margin-bottom:8px;">Send the 10th, 20th, 30th... message to claim your reward NFT</div>
      <div style="background:#f5f5f5;padding:8px;border-radius:6px;font-size:12px;color:#000000;">
        UI will indicate if you're a winner â€” just click claim button
      </div>
      <div style="margin-top:8px;font-size:12px;color:#000000;">NFT Contract: <span style="color:#000000;font-family:monospace;font-weight:600;">0x1330fF8C16fDDF65e3A09e3c552C43B9D930C216</span></div>
    </div>
    
    <div id="milestone-winners" style="margin-top:12px;"></div>
    <div id="claim-section" style="margin-top:12px;"></div>
  </div>
  <footer style="text-align:center;padding:24px 0;color:#64748b;font-size:13px;">
    Built on Somnia âš¡ | Made by <a href="https://edwardtay.com" target="_blank" style="color:#a855f7;text-decoration:none;">Edward</a>
  </footer>
  <script src="/app.js"></script>
</body>
</html>
